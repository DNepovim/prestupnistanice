---
import { getCollection } from 'astro:content'

import Layout from '../layouts/Layout.astro'
import { CATEGORIES, categoriesSlugToKey, type CategorySlug } from '../routes'
import BooksList from './BooksList.astro'

interface Props {
  slug: CategorySlug
}

const { slug } = Astro.props

const categoryKey = categoriesSlugToKey[slug]

const books = await getCollection('book', (b) => b.data.category === categoryKey)

const categoryName = CATEGORIES[categoryKey].name
---

<Layout
  siteTitle={`Naše knihy ${categoryName}`}
  siteDescription={`Naše knihy ${categoryName}`}
>
  <BooksList books={books} slug={slug} />
</Layout>
