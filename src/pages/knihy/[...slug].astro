---
import { getCollection } from "astro:content";
import { categoriesSlugToKey } from "../../routes";
import BookDetail from "../../components/BookDetail.astro";
import BooksCategory from "../../components/BooksCategory.astro";

export async function getStaticPaths() {
  const posts = await getCollection("book");

  return [
    ...posts.map(({ id }) => id),
    ...Object.keys(categoriesSlugToKey),
  ].map((slug) => ({
    params: { slug },
  }));
}

const { slug } = Astro.params;
---

{
  Object.keys(categoriesSlugToKey).includes(slug) ? (
    <BooksCategory slug={slug} />
  ) : (
    <BookDetail slug={slug} />
  )
}
