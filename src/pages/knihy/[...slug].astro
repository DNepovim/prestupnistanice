---
import { getCollection } from 'astro:content'

import BookDetail from '../../components/BookDetail.astro'
import BooksCategory from '../../components/BooksCategory.astro'
import { categoriesSlugToKey } from '../../routes'

export async function getStaticPaths() {
  const posts = await getCollection('book')

  return [...posts.map(({ data }) => data.slug), ...Object.keys(categoriesSlugToKey)].map(
    (slug) => ({
      params: { slug },
    }),
  )
}

const { slug } = Astro.params
---

{
  Object.keys(categoriesSlugToKey).includes(slug) ? (
    <BooksCategory slug={slug} />
  ) : (
    <BookDetail slug={slug} />
  )
}
