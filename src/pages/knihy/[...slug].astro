---
import { getCollection } from "astro:content";
import { categoriesSlugToKey } from "../../routes";
import BookDetail from "../../components/BookDetail.astro";
import BooksCategory from "../../components/BooksCategory.astro";
import PageTitle from "../../components/PageTitle.astro";
import Section from "../../components/Section.astro";
import Book from "../../components/Book.astro";
import BooksGrid from "../../components/BooksGrid.astro";
import { isDefined } from "../../utils/isDefined";
import { routes } from "../../routes";
import { rolesMap } from "../../utils/rolesMap";
import { AddToCartButton } from "../../components/AddToCartButton";

export async function getStaticPaths() {
  const posts = await getCollection("book");

  return [
    ...posts.map(({ id }) => id),
    ...Object.keys(categoriesSlugToKey),
  ].map((slug) => ({
    params: { slug },
  }));
}

const { slug } = Astro.params;
---

{
  Object.keys(categoriesSlugToKey).includes(slug) ? (
    <BooksCategory slug={slug} />
  ) : (
    <BookDetail slug={slug} />
  )
}
